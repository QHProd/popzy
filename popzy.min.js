Popzy.openingModals=[];function Popzy(options={}){this.opt=Object.assign({closeMethods:["button","overlay","escape"],enableSrcollLock:true,footer:false,cssClass:[],destroyOnClose:true,scrollLockTarget:()=>document.body},options);const{content:content,templateId:templateId,closeMethods:closeMethods}=this.opt;if(content&&templateId){console.warn(`[${this.constructor.name}] Warning: both 'content' and 'templateId' provided â€” `+`'content' will be used and 'templateId' will be ignored.`)}if(typeof content==="string"&&content.trim()!==""){this.content=content}else if(typeof templateId==="string"){this.template=document.getElementById(templateId)}if(!this.content&&!this.template){const reason=typeof templateId==="string"?`Template "#${templateId}" not found in DOM`:`Provide non-empty 'content' (string) or a valid 'templateId' (string)`;throw new Error(`[${this.constructor.name}] Initialization failed: ${reason}.`)}this._allowButtonClose=closeMethods.includes("button");this._allowBackdropClose=closeMethods.includes("overlay");this._allowEscapeClose=closeMethods.includes("escape");this._isModalOpening=false;this._footerButtons=[];this.escapeHandler=this.escapeHandler.bind(this)}Popzy.prototype.build=function(){const content=this.content||this.template.content.cloneNode(true);this._backdrop=document.createElement("div");this._backdrop.classList.add("popzy");const modalContainer=document.createElement("div");modalContainer.classList.add("popzy__container");this.opt.cssClass.forEach(className=>{if(typeof className==="string"){modalContainer.classList.add(className)}});if(this._allowButtonClose){const closeBtn=this._createButton("&times;","popzy--close",()=>{this.close()});modalContainer.append(closeBtn)}this._modalContent=document.createElement("div");this._modalContent.classList.add("popzy__content");if(this.content){this._modalContent.innerHTML=content}else{this._modalContent.append(content)}modalContainer.append(this._modalContent);this._backdrop.append(modalContainer);document.body.append(this._backdrop);if(this.opt.footer){this._modalFooter=document.createElement("div");this._modalFooter.classList.add("popzy__footer");if(this._footerContent){this._modalFooter.innerHTML=this._footerContent}this._renderFooterButtons();modalContainer.append(this._modalFooter)}if(this._allowBackdropClose){this._backdrop.addEventListener("click",e=>{if(e.target===this._backdrop){this.close()}})}};Popzy.prototype._hasScrollbar=function(target){const html=document.documentElement;const body=document.body;if([html,body].includes(target)){return html.scrollHeight>html.clientHeight||body.scrollHeight>body.clientHeight}return target.scrollHeight>target.clientHeight};Popzy.prototype._getScrollbarWidth=function(){if(this._scrollbarWidth)return this._scrollbarWidth;const div=document.createElement("div");div.style.overflow="scroll";div.style.position="absolute";div.style.top="-9999px";document.body.appendChild(div);this._scrollbarWidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._scrollbarWidth};Popzy.prototype._createButton=function(title,classListStr,action){const button=document.createElement("button");button.innerHTML=title;if(typeof classListStr==="string"&&classListStr.length>0){classListStr.split(" ").forEach(className=>{button.classList.add(className)})}button.addEventListener("click",action);return button};Popzy.prototype.setContent=function(content){this.content=content;if(this._modalContent){this._modalContent.innerHTML=content}};Popzy.prototype.setFooterContent=function(content="<h4>This is default footer...</h4>"){this._footerContent=content;if(this._modalFooter){this._modalFooter.innerHTML=content}};Popzy.prototype.addFooterButton=function(title,classListStr,action){if(!this.opt.footer)return;const isAppended=this._footerButtons.some(button=>button.innerHTML.trim()===title.trim()||button.innerText.trim()===title.trim());if(isAppended)return;const footerButton=this._createButton(title,classListStr,action);footerButton.classList.add("popzy__footer-button");this._footerButtons.push(footerButton);this._renderFooterButtons()};Popzy.prototype._renderFooterContent=function(){if(this._footerContent&&this._modalFooter){this._modalFooter.innerHTML=this._footerContent}};Popzy.prototype._renderFooterButtons=function(){if(this._modalFooter){this._footerButtons.forEach(button=>{this._modalFooter.append(button)})}};Popzy.prototype.escapeHandler=function(e){const lastOpenedModal=Popzy.openingModals.slice(-1)[0];if(e.key==="Escape"){if(lastOpenedModal&&lastOpenedModal===this)this.close()}};Popzy.prototype.open=function(){if(this._isModalOpening)this.close();if(!this._backdrop){this.build()}Popzy.openingModals.push(this);setTimeout(()=>{this._backdrop.classList.add("popzy--show")},0);if(this.opt.enableSrcollLock){const target=this.opt.scrollLockTarget();if(Popzy.openingModals.length===1&&this._hasScrollbar(target)){target.classList.add("popzy--no-scroll");const currentPaddingRight=parseFloat(getComputedStyle(target).paddingRight);target.style.paddingRight=currentPaddingRight+this._getScrollbarWidth()+"px"}}this._backdrop.addEventListener("transitionend",()=>{typeof this.opt.onOpen==="function"&&this.opt.onOpen();this._isModalOpening=true},{once:true});if(this._allowEscapeClose){document.addEventListener("keydown",this.escapeHandler)}return this._backdrop};Popzy.prototype.close=function(shouldDestroy=this.opt.destroyOnClose){if(!this._isModalOpening)return;Popzy.openingModals.pop();this._backdrop.classList.remove("popzy--show");let timeoutId=null;this._backdrop.addEventListener("transitionend",e=>{typeof this.opt.onClose==="function"&&this.opt.onClose();this._isModalOpening=false;if(!Popzy.openingModals.length&&this.opt.enableSrcollLock){const target=this.opt.scrollLockTarget();if(this._hasScrollbar(target)){target.classList.remove("popzy--no-scroll");target.style.paddingRight=""}}if(shouldDestroy&&this._backdrop){this._backdrop.remove();this._backdrop=null;this._modalFooter=null}document.removeEventListener("keydown",this.escapeHandler);clearTimeout(timeoutId)},{once:true});timeoutId=setTimeout(()=>{if(shouldDestroy&&this._backdrop){this._backdrop.remove();this._backdrop=null}},1e3)};Popzy.prototype.destroy=function(){if(!this._backdrop)return;this.close(true)};